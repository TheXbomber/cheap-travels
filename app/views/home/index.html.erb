<!-- Alessandro -->

<%= stylesheet_link_tag "home.css" %>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">


<% if user_signed_in? %>
	
<% else %>
	
<% end %>


<div class="container p-3 ">
	<h4>Nuova ricerca</h4>
</div>

<!--<div class="autocomplete-container" id="autocomplete-container"></div>-->

<!--form ricerca -->
<%= form_with scope: "search", url: search_results_path, method: :post do |form| %>
	<div class="container search shadow-sm p-3 d-flex justify-content-center rounded-3">
		<div class="row g-3 search  d-flex justify-content-center ">  
			<div class="col-3">
				<%= form.text_field :origin, placeholder: "Luogo di partenza", :required => true, autofocus: true, class: "form-control"%>
			</div>
			<!--<%= form.select :origin, [["Roma", "AGP"], ["Malaga", "AGP"], ["Milano", "LIN"]],  presence: true%> -->
			<div class="col-2">
				<%= form.date_field :departure, :value => Time.now.strftime('%Y-%m-%d'), :required => true, class: "form-control"%>
			</div>	
			<div class="col-2">
				<%= form.date_field :return, :value => Time.now.strftime('%Y-%m-%d'), :required => true, class: "form-control"%>
			</div>
			<div class="col-2">
				<%= form.text_field :budget, placeholder: "Budget", :required => true, class: "form-control"%>
			</div>
			<div class="col-2">
				<%= form.number_field :people, in: 1.0..10.0, step: 1.0, placeholder: "Persone", :required => true, class: "form-control"%>
			</div>
			<div class="col-1">
				<%= form.submit :search, class:"btn btn-primary", value: "Cerca" %>	
			</div>
		</div>
	</div>
<% end %> 
<br>

<div class="container p-2">
<h4>Destinazioni pi√π cercate</h4>
	<div class="row g-3 search  d-flex justify-content-center "> 

		<%@destinations.each do |dest|%>
	       <div class="col">
			<div class="card bg-light text-white h-100 shadow-sm" style="width: 100%rem;">
				<img class="card-img photo" src="<%= @photo_home[dest.iata]%>" alt="Card image">
				<div class="card-img-overlay photo">
					<h5 class="card-title city_name"><%= dest.name %></h5>
					 <a href="#" class="stretched-link"></a>
				</div>
				</div>
			</div>

		<%end%>

	</div>
</div>

<% if user_signed_in? %>
	<%if current_user.role == "moderator" %>
		<div class="container d-flex justify-content-end mt-2 p-2">
			<button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#destModal">
				Modifica destinazioni
			</button> 
	<%end%>
<%end%>
		</div>

<!-- Modal cambio destinazioni -->
<div class="modal fade" id="destModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-target="ricercaModal">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
    <%= form_with url: update_dest_path, method: :post do |form| %>  
      <div class="modal-header">
        <h6 class="modal-title" id="exampleModalLabel">Modifica destinazioni</h6>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
          <div id="modifica">
            
				<% @destinations.each do |dest| %>
					<div>
						<%= form.select :"city#{dest.id}", @cities_select, :selected => dest.iata, class: "form-control p-5" %>
						<br>
					</div>
				<% end %>
				<!--<%= form.select :city, @cities_select, class: "form-control" %>-->
            
      </div>
      </div>
      <div class="modal-footer">
	  
        <%= form.submit :search, class:"btn btn-primary", value: "Modifica" %>	
      </div>
      <%end%>
    </div>
  </div>
</div>