<%if @message%>
    <p><%=@message%></p>
<%else%>
    <h1><%=params[:destinationplace].downcase.capitalize()%></h1>
    <%if @errorinfo%>
        <p><%=@errorinfo%></p>
    <%else%>
        <%if @type%><p><b>Tipo: </b><%=@type%><p><%end%>
        <%if @country%><p><b>Nazione: </b><%=@country%><p><%end%>
        <%if @region%><p><b>Regione: </b><%=@region%><p><%end%>
        <%if @elevationmeters%><p><b>Altitudine: </b><%=@elevationmeters%> m<p><%end%>
        <%if @population%><p><b>Popolazione: </b><%=@population%> abitanti<p><%end%>
        <%if @longitude%><p><b>Longitudine: </b><%=@longitude%><p><%end%>
        <%if @latitude%><p><b>Latitudine: </b><%=@latitude%><p><%end%>
        <%if @capital%><p><b>Capitale: </b><%=@capital%><p><%end%>
        <%if @numregions%><p><b>Numero di regioni: </b><%=@numregions%><p><%end%>
    <%end%>

    <%if @hotels%>
        <ul>
            <%(0...2).each do |i|%>
                <%if @hotels[i]%>
                    <li>
                        <img src="<%=@hotels[i]["main_photo_url"]%>">
                        <a href="<%=@hotels[i]["url"]%>"><%=@hotels[i]["hotel_name"]%></a>
                        <p>Prezzo: <%=@hotels[i]["price_breakdown"]["all_inclusive_price"]%>€</p>
                        <%if @hotels[i]["is_free_cancellable"]==1%>
                            <p>Cancellazione gratuita</p>
                        <%end%>
                        <p>Review Score: <%=@hotels[i]["review_score"]%></p>
                        <p>
                            <%if @hotels[i]["hotel_include_breakfast"]==0%>
                                Colazione inclusa: NO
                            <%else%>
                                Colazione inclusa: SI
                            <%end%>
                        </p>
                        <p>Check-in 
                            <%if @hotels[i]["checkin"]["from"]!=""%>
                                dalle <%=@hotels[i]["checkin"]["from"]%> 
                            <%end%>
                            <%if @hotels[i]["checkin"]["until"]!=""%>
                                <%if @hotels[i]["checkin"]["from"]!=""%>
                                    alle <%=@hotels[i]["checkin"]["until"]%>
                                <%else%>
                                    fino alle <%=@hotels[i]["checkin"]["until"]%>
                                <%end%>
                            <%end%>
                        </p>
                        <p>Check-out
                            <%if @hotels[i]["checkout"]["from"]!=""%>
                                dalle <%=@hotels[i]["checkout"]["from"]%> 
                            <%end%>
                            <%if @hotels[i]["checkout"]["until"]!=""%>
                                <%if @hotels[i]["checkout"]["from"]!=""%>
                                    alle <%=@hotels[i]["checkout"]["until"]%>
                                <%else%>
                                    fino alle <%=@hotels[i]["checkout"]["until"]%>
                                <%end%>
                            <%end%>
                        </p>
                    </li>
                <%end%>
            <%end%>
        </ul>
    <%end%>

    <%if @voliarr%>
        <ul>
            <%(0...2).each do |k|%>
                <li>
                    <%@arr=@arrvoliandata[k]["segments"]%>
                    <img src="http://pics.avs.io/200/200/<%=@arr[0]["carrierCode"]%>.png">
                    <ul>
                        <li>
                            <h5>
                                Andata (n°scali: <%=@arrnumeroscaliandata[k]%>):
                                <%if @arrnumeroscaliandata[k]==0%>
                                    <%=@arr[0]["departure"]["iataCode"]%> - <%=@arr[0]["arrival"]["iataCode"]%>
                                <%else%>
                                    <%(0..@arrnumeroscaliandata[k]).each do |i|%>
                                        <%if i==@arrnumeroscaliandata[k]%>
                                            - <%=@arr[i]["departure"]["iataCode"]%> - <%=@arr[i]["arrival"]["iataCode"]%>
                                        <%else-if i!=0%>
                                            - <%=@arr[i]["departure"]["iataCode"]%>
                                        <%else%>
                                             <%=@arr[i]["departure"]["iataCode"]%>
                                        <%end%>
                                        <%end%>
                                    <%end%>
                                <%end%>
                            </h5>
                            <p>
                                <%if @arrnumeroscaliandata[k]==0%>
                                    <b><%=@arr[0]["departure"]["iataCode"]%></b> - Partenza: <%elem=@arr[0]["departure"]["at"].split("T")%><%=elem[1]%> 
                                            <%@dativoli["dictionaries"]["carriers"].keys.each do |compagniacode|%>
                                                <%if @arr[0]["carrierCode"]==compagniacode%>
                                                    (<%=@dativoli["dictionaries"]["carriers"]["#{compagniacode}"]%>)
                                                <%end%>
                                            <%end%><br>
                                    <b><%=@arr[0]["arrival"]["iataCode"]%></b> - Arrivo: <%elem=@arr[0]["arrival"]["at"].split("T")%><%=elem[1]%>
                                <%else%>
                                    <%(0..@arrnumeroscaliandata[k]).each do |i|%>
                                        <b><%=@arr[i]["departure"]["iataCode"]%></b> - Partenza: <%elem=@arr[i]["departure"]["at"].split("T")%><%=elem[1]%>
                                            <%@dativoli["dictionaries"]["carriers"].keys.each do |compagniacode|%>
                                                <%if @arr[i]["carrierCode"]==compagniacode%>
                                                    (<%=@dativoli["dictionaries"]["carriers"]["#{compagniacode}"]%>)
                                                <%end%>
                                            <%end%><br>
                                        <b><%=@arr[i]["arrival"]["iataCode"]%></b> - Arrivo: <%elem=@arr[i]["arrival"]["at"].split("T")%><%=elem[1]%><br>
                                    <%end%>
                                <%end%>
                            </p>
                        </li>
                        <li>
                            <%@arr=@arrvoliritorno[k]["segments"]%>
                            <h5>
                                Ritorno (n°scali: <%=@arrnumeroscaliritorno[k]%>):
                                <%if @arrnumeroscaliritorno[k]==0%>
                                    <%=@arr[0]["departure"]["iataCode"]%>-<%=@arr[0]["arrival"]["iataCode"]%>
                                <%else%>
                                    <%(0..@arrnumeroscaliritorno[k]).each do |i|%>
                                        <%if i==@arrnumeroscaliritorno[k]%>
                                            - <%=@arr[i]["departure"]["iataCode"]%> - <%=@arr[i]["arrival"]["iataCode"]%>
                                        <%else-if i!=0%>
                                            - <%=@arr[i]["departure"]["iataCode"]%>
                                        <%else%>
                                             <%=@arr[i]["departure"]["iataCode"]%>
                                        <%end%>
                                        <%end%>
                                    <%end%>
                                <%end%>
                            </h5>
                            <p>
                                <%if @arrnumeroscaliritorno[k]==0%>
                                    <b><%=@arr[0]["departure"]["iataCode"]%></b> - Partenza: <%elem=@arr[0]["departure"]["at"].split("T")%><%=elem[1]%>
                                        <%@dativoli["dictionaries"]["carriers"].keys.each do |compagniacode|%>
                                            <%if @arr[0]["carrierCode"]==compagniacode%>
                                                (<%=@dativoli["dictionaries"]["carriers"]["#{compagniacode}"]%>)
                                            <%end%>
                                        <%end%><br>
                                    <b><%=@arr[0]["arrival"]["iataCode"]%></b> - Arrivo: <%elem=@arr[0]["arrival"]["at"].split("T")%><%=elem[1]%>
                                <%else%>
                                    <%(0..@arrnumeroscaliritorno[k]).each do |i|%>
                                        <b><%=@arr[i]["departure"]["iataCode"]%></b> - Partenza: <%elem=@arr[i]["departure"]["at"].split("T")%><%=elem[1]%>
                                            <%@dativoli["dictionaries"]["carriers"].keys.each do |compagniacode|%>
                                                <%if @arr[i]["carrierCode"]==compagniacode%>
                                                    (<%=@dativoli["dictionaries"]["carriers"]["#{compagniacode}"]%>)
                                                <%end%>
                                            <%end%><br>
                                        <b><%=@arr[i]["arrival"]["iataCode"]%></b> - Arrivo: <%elem=@arr[i]["arrival"]["at"].split("T")%><%=elem[1]%><br>
                                    <%end%>
                                <%end%>
                            </p>
                        </li>
                        <li><p>Prezzo totale per <%=params[:numpersone]%> persone: <%=@voliarr[k]["price"]["grandTotal"]%>€ (i prezzi includono sia l'andata che il ritorno) </p></li>
                    </ul>
                </li>
            <%end%>
        </ul>
    <%end%>
<%end%>
