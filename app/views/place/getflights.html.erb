<%= stylesheet_link_tag "place.css" %>

<h1 style="text-align:center">Flights for <%=@destinationplace%></h1>
<%if @voliarr%>
    <ul style="list-style-type:none">
        <%length=@voliarr.length%>
        <%if length%2==0%>
            <%length=length/2%>
        <%else%>
            <%length=(length-1)/2%>
        <%end%>
        <%(0...length).each do |k|%>
            <div style="display: flex; padding: 0px 50px 0px 50px">
                <li style="width: 50%; padding: 0px 10px 0px 10px">
                    <div style="height:100%; display:flex; border-style: solid; border-radius: 10px">
                        <%@arr=@arrvoliandata[2*k]["segments"]%>
                        <img style="width: 39%; height:auto; border-radius: 7px" src="http://pics.avs.io/200/200/<%=@arr[0]["carrierCode"]%>.png">
                        <div class="elem" style="width: 70%; padding: 10px 10px 10px 10px">
                            <ul style="list-style-type:none">
                                <li>
                                    <h5>
                                        Andata (n°scali: <%=@arrnumeroscaliandata[2*k]%>):
                                        <%if @arrnumeroscaliandata[2*k]==0%>
                                            <%=@arr[0]["departure"]["iataCode"]%> - <%=@arr[0]["arrival"]["iataCode"]%>
                                        <%else%>
                                            <%(0..@arrnumeroscaliandata[2*k]).each do |i|%>
                                                <%if i==@arrnumeroscaliandata[2*k]%>
                                                    - <%=@arr[i]["departure"]["iataCode"]%> - <%=@arr[i]["arrival"]["iataCode"]%>
                                                <%else-if i!=0%>
                                                    - <%=@arr[i]["departure"]["iataCode"]%>
                                                <%else%>
                                                    <%=@arr[i]["departure"]["iataCode"]%>
                                                <%end%>
                                                <%end%>
                                            <%end%>
                                        <%end%>
                                    </h5>
                                    <p>
                                        <%if @arrnumeroscaliandata[2*k]==0%>
                                            <b><%=@arr[0]["departure"]["iataCode"]%></b> - Partenza: <%elem=@arr[0]["departure"]["at"].split("T")%><%=elem[1]%> 
                                                    <%@dativoli["dictionaries"]["carriers"].keys.each do |compagniacode|%>
                                                        <%if @arr[0]["carrierCode"]==compagniacode%>
                                                            (<%=@dativoli["dictionaries"]["carriers"]["#{compagniacode}"]%>)
                                                        <%end%>
                                                    <%end%><br>
                                            <b><%=@arr[0]["arrival"]["iataCode"]%></b> - Arrivo: <%elem=@arr[0]["arrival"]["at"].split("T")%><%=elem[1]%>
                                        <%else%>
                                            <%(0..@arrnumeroscaliandata[2*k]).each do |i|%>
                                                <b><%=@arr[i]["departure"]["iataCode"]%></b> - Partenza: <%elem=@arr[i]["departure"]["at"].split("T")%><%=elem[1]%>
                                                    <%@dativoli["dictionaries"]["carriers"].keys.each do |compagniacode|%>
                                                        <%if @arr[i]["carrierCode"]==compagniacode%>
                                                            (<%=@dativoli["dictionaries"]["carriers"]["#{compagniacode}"]%>)
                                                        <%end%>
                                                    <%end%><br>
                                                <b><%=@arr[i]["arrival"]["iataCode"]%></b> - Arrivo: <%elem=@arr[i]["arrival"]["at"].split("T")%><%=elem[1]%><br>
                                            <%end%>
                                        <%end%>
                                    </p>
                                </li>
                                <li>
                                    <%@arr=@arrvoliritorno[2*k]["segments"]%>
                                    <h5>
                                        Ritorno (n°scali: <%=@arrnumeroscaliritorno[2*k]%>):
                                        <%if @arrnumeroscaliritorno[2*k]==0%>
                                            <%=@arr[0]["departure"]["iataCode"]%> - <%=@arr[0]["arrival"]["iataCode"]%>
                                        <%else%>
                                            <%(0..@arrnumeroscaliritorno[2*k]).each do |i|%>
                                                <%if i==@arrnumeroscaliritorno[2*k]%>
                                                    - <%=@arr[i]["departure"]["iataCode"]%> - <%=@arr[i]["arrival"]["iataCode"]%>
                                                <%else-if i!=0%>
                                                    - <%=@arr[i]["departure"]["iataCode"]%>
                                                <%else%>
                                                    <%=@arr[i]["departure"]["iataCode"]%>
                                                <%end%>
                                                <%end%>
                                            <%end%>
                                        <%end%>
                                    </h5>
                                    <p>
                                        <%if @arrnumeroscaliritorno[2*k]==0%>
                                            <b><%=@arr[0]["departure"]["iataCode"]%></b> - Partenza: <%elem=@arr[0]["departure"]["at"].split("T")%><%=elem[1]%>
                                                <%@dativoli["dictionaries"]["carriers"].keys.each do |compagniacode|%>
                                                    <%if @arr[0]["carrierCode"]==compagniacode%>
                                                        (<%=@dativoli["dictionaries"]["carriers"]["#{compagniacode}"]%>)
                                                    <%end%>
                                                <%end%><br>
                                            <b><%=@arr[0]["arrival"]["iataCode"]%></b> - Arrivo: <%elem=@arr[0]["arrival"]["at"].split("T")%><%=elem[1]%>
                                        <%else%>
                                            <%(0..@arrnumeroscaliritorno[2*k]).each do |i|%>
                                                <b><%=@arr[i]["departure"]["iataCode"]%></b> - Partenza: <%elem=@arr[i]["departure"]["at"].split("T")%><%=elem[1]%>
                                                    <%@dativoli["dictionaries"]["carriers"].keys.each do |compagniacode|%>
                                                        <%if @arr[i]["carrierCode"]==compagniacode%>
                                                            (<%=@dativoli["dictionaries"]["carriers"]["#{compagniacode}"]%>)
                                                        <%end%>
                                                    <%end%><br>
                                                <b><%=@arr[i]["arrival"]["iataCode"]%></b> - Arrivo: <%elem=@arr[i]["arrival"]["at"].split("T")%><%=elem[1]%><br>
                                            <%end%>
                                        <%end%>
                                    </p>
                                </li>
                                <li><p>Prezzo totale a persona: <%=@voliarr[2*k]["price"]["grandTotal"]%>€ (i prezzi includono sia l'andata che il ritorno) </p></li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li style="width: 50%; padding: 0px 10px 0px 10px">
                    <div style="height:100%; display:flex; border-style: solid; border-radius: 10px">
                        <%@arr=@arrvoliandata[(2*k)+1]["segments"]%>
                        <img style="width: 39%; height:auto; border-radius: 7px" src="http://pics.avs.io/200/200/<%=@arr[0]["carrierCode"]%>.png">
                        <div class="elem" style="width: 70%; padding: 10px 10px 10px 10px">
                            <ul style="list-style-type:none">
                                <li>
                                    <h5>
                                        Andata (n°scali: <%=@arrnumeroscaliandata[(2*k)+1]%>):
                                        <%if @arrnumeroscaliandata[(2*k)+1]==0%>
                                            <%=@arr[0]["departure"]["iataCode"]%> - <%=@arr[0]["arrival"]["iataCode"]%>
                                        <%else%>
                                            <%(0..@arrnumeroscaliandata[(2*k)+1]).each do |i|%>
                                                <%if i==@arrnumeroscaliandata[(2*k)+1]%>
                                                    - <%=@arr[i]["departure"]["iataCode"]%> - <%=@arr[i]["arrival"]["iataCode"]%>
                                                <%else-if i!=0%>
                                                    - <%=@arr[i]["departure"]["iataCode"]%>
                                                <%else%>
                                                    <%=@arr[i]["departure"]["iataCode"]%>
                                                <%end%>
                                                <%end%>
                                            <%end%>
                                        <%end%>
                                    </h5>
                                    <p>
                                        <%if @arrnumeroscaliandata[(2*k)+1]==0%>
                                            <b><%=@arr[0]["departure"]["iataCode"]%></b> - Partenza: <%elem=@arr[0]["departure"]["at"].split("T")%><%=elem[1]%> 
                                                    <%@dativoli["dictionaries"]["carriers"].keys.each do |compagniacode|%>
                                                        <%if @arr[0]["carrierCode"]==compagniacode%>
                                                            (<%=@dativoli["dictionaries"]["carriers"]["#{compagniacode}"]%>)
                                                        <%end%>
                                                    <%end%><br>
                                            <b><%=@arr[0]["arrival"]["iataCode"]%></b> - Arrivo: <%elem=@arr[0]["arrival"]["at"].split("T")%><%=elem[1]%>
                                        <%else%>
                                            <%(0..@arrnumeroscaliandata[(2*k)+1]).each do |i|%>
                                                <b><%=@arr[i]["departure"]["iataCode"]%></b> - Partenza: <%elem=@arr[i]["departure"]["at"].split("T")%><%=elem[1]%>
                                                    <%@dativoli["dictionaries"]["carriers"].keys.each do |compagniacode|%>
                                                        <%if @arr[i]["carrierCode"]==compagniacode%>
                                                            (<%=@dativoli["dictionaries"]["carriers"]["#{compagniacode}"]%>)
                                                        <%end%>
                                                    <%end%><br>
                                                <b><%=@arr[i]["arrival"]["iataCode"]%></b> - Arrivo: <%elem=@arr[i]["arrival"]["at"].split("T")%><%=elem[1]%><br>
                                            <%end%>
                                        <%end%>
                                    </p>
                                </li>
                                <li>
                                    <%@arr=@arrvoliritorno[(2*k)+1]["segments"]%>
                                    <h5>
                                        Ritorno (n°scali: <%=@arrnumeroscaliritorno[(2*k)+1]%>):
                                        <%if @arrnumeroscaliritorno[(2*k)+1]==0%>
                                            <%=@arr[0]["departure"]["iataCode"]%> - <%=@arr[0]["arrival"]["iataCode"]%>
                                        <%else%>
                                            <%(0..@arrnumeroscaliritorno[(2*k)+1]).each do |i|%>
                                                <%if i==@arrnumeroscaliritorno[(2*k)+1]%>
                                                    - <%=@arr[i]["departure"]["iataCode"]%> - <%=@arr[i]["arrival"]["iataCode"]%>
                                                <%else-if i!=0%>
                                                    - <%=@arr[i]["departure"]["iataCode"]%>
                                                <%else%>
                                                    <%=@arr[i]["departure"]["iataCode"]%>
                                                <%end%>
                                                <%end%>
                                            <%end%>
                                        <%end%>
                                    </h5>
                                    <p>
                                        <%if @arrnumeroscaliritorno[(2*k)+1]==0%>
                                            <b><%=@arr[0]["departure"]["iataCode"]%></b> - Partenza: <%elem=@arr[0]["departure"]["at"].split("T")%><%=elem[1]%>
                                                <%@dativoli["dictionaries"]["carriers"].keys.each do |compagniacode|%>
                                                    <%if @arr[0]["carrierCode"]==compagniacode%>
                                                        (<%=@dativoli["dictionaries"]["carriers"]["#{compagniacode}"]%>)
                                                    <%end%>
                                                <%end%><br>
                                            <b><%=@arr[0]["arrival"]["iataCode"]%></b> - Arrivo: <%elem=@arr[0]["arrival"]["at"].split("T")%><%=elem[1]%>
                                        <%else%>
                                            <%(0..@arrnumeroscaliritorno[(2*k)+1]).each do |i|%>
                                                <b><%=@arr[i]["departure"]["iataCode"]%></b> - Partenza: <%elem=@arr[i]["departure"]["at"].split("T")%><%=elem[1]%>
                                                    <%@dativoli["dictionaries"]["carriers"].keys.each do |compagniacode|%>
                                                        <%if @arr[i]["carrierCode"]==compagniacode%>
                                                            (<%=@dativoli["dictionaries"]["carriers"]["#{compagniacode}"]%>)
                                                        <%end%>
                                                    <%end%><br>
                                                <b><%=@arr[i]["arrival"]["iataCode"]%></b> - Arrivo: <%elem=@arr[i]["arrival"]["at"].split("T")%><%=elem[1]%><br>
                                            <%end%>
                                        <%end%>
                                    </p>
                                </li>
                                <li><p>Prezzo totale a persona: <%=@voliarr[(2*k)+1]["price"]["grandTotal"]%>€ (i prezzi includono sia l'andata che il ritorno) </p></li>
                            </ul>
                        </div>
                    </div>
                </li>
            </div>
            <br>
        <%end%>
    </ul>
<%else%>
    <%if @messageflights%>
        <h4 style="color:red; text-align: center">Error: <%=@messageflights%></h4>
    <%end%>
<%end%>